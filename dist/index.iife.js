var yamiLoader=function(o){"use strict";var P=Object.defineProperty,$=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var O=(o,r,n)=>r in o?P(o,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[r]=n,S=(o,r)=>{for(var n in r||(r={}))q.call(r,n)&&O(o,n,r[n]);if(w)for(var n of w(r))A.call(r,n)&&O(o,n,r[n]);return o},p=(o,r)=>$(o,R(r));var T=(o,r,n)=>(O(o,typeof r!="symbol"?r+"":r,n),n);var C=(o,r,n)=>new Promise((g,j)=>{var y=f=>{try{l(n.next(f))}catch(d){j(d)}},E=f=>{try{l(n.throw(f))}catch(d){j(d)}},l=f=>f.done?g(f.value):Promise.resolve(f.value).then(y,E);l((n=n.apply(o,r)).next())});var r=(d=>(d.LOAD="_load",d.ERROR="_error",d.COMPLETE="_complete",d))(r||{});const n=document.head||document.body,g="loaded",j=["body","frame","frameset","iframe","img","link","script","style"],y=(d,i)=>document.dispatchEvent(new CustomEvent(d,{detail:i}));function E(d,i,t){let e=t.id?n.querySelector("#"+t.id):null;if(!e){const h=`${i}[${i==="link"?"href":"src"}="${d}"]`;e=n.querySelector(h)}return e||(e=document.createElement(i),Object.assign(e,t),n.appendChild(e)),e}class l{constructor(i){T(this,"timeout",15e3);T(this,"LoaderEvent",r);Object.assign(this,i)}load(i,t={},e={}){const h=t.href||t.src;let s=E(h,i,t),c,v=0;return new Promise((u,m)=>{function a(){u({el:s,options:t})}function _(L){m({reason:typeof L=="string"?L:`Failed to load ${h}`,options:t})}if(j.includes(i))if(h){if(s.getAttribute(g)==="1")return a()}else return _("Not found the source address");else return a();s.addEventListener("load",a,!1),s.addEventListener("error",_,!1),c=()=>{var L;s.removeEventListener("load",a,!1),s.removeEventListener("error",_,!1),y("_complete",t),(L=e.oncomplete)==null||L.call(e,t),clearTimeout(v)},v=setTimeout(()=>_(`Time out of ${this.timeout} ms`),this.timeout)}).then(u=>{var m;return s.setAttribute(g,"1"),"_jsonp_"in t||(y("_load",u),(m=e.onload)==null||m.call(e,u.el,u.options)),u}).catch(u=>{var a;s.remove();const m={reason:u,options:t};return y("_error",m),(a=e.onerror)==null||a.call(e,u,t),Promise.reject(m)}).finally(c)}loadScript(i,t,e){return this.load("script",p(S({},t),{defer:!0,async:!0,type:"text/javascript",crossOrigin:"anonymous",src:i}),e)}loadCss(i,t,e){return this.load("link",p(S({},t),{rel:"stylesheet",type:"text/css",crossOrigin:"anonymous",href:i}),e)}jsonp(i,t,e){return C(this,null,function*(){const[h,s]=i.split("?"),c=new URLSearchParams(s);c.append(t.name||"jsonCallback",t.callee);const v=e==null?void 0:e.onload;e==null||delete e.onload;const{el:u,options:m}=yield this.loadScript(h+"?"+c.toString(),Object.assign(t,{_jsonp_:!0}),e),a=globalThis[t.callee]();globalThis[t.callee]=null,u.remove();const _={data:a,options:m};return y("_load",_),v==null||v.call(e,a,m),_})}}const f=new l;return o.LoaderEvent=r,o.YamiLoader=l,o.default=l,o.yamiLoader=f,Object.defineProperties(o,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),o}({});
