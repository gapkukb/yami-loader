var yamiLoader=function(l){"use strict";var S=Object.defineProperty,C=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var L=(l,n,o)=>n in l?S(l,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[n]=o,f=(l,n)=>{for(var o in n||(n={}))j.call(n,o)&&L(l,o,n[o]);if(p)for(var o of p(n))P.call(n,o)&&L(l,o,n[o]);return l},y=(l,n)=>C(l,T(n));var w=(l,n,o)=>new Promise((v,h)=>{var m=e=>{try{r(o.next(e))}catch(t){h(t)}},O=e=>{try{r(o.throw(e))}catch(t){h(t)}},r=e=>e.done?v(e.value):Promise.resolve(e.value).then(m,O);r((o=o.apply(l,n)).next())});var n=(r=>(r.LOAD="load",r.ERROR="error",r.COMPLETE="complete",r))(n||{});const o=document.head||document.getElementsByTagName("head")[0]||document.body,v="loaded";function h(r,e,t){let a=t.id?document.getElementById(t.id):null;if(!a){const d=`${e}[${e==="link"?"href":"src"}="${r}"]`;a=o.querySelector(d)}return a||(a=document.createElement(e),Object.assign(a,t),o.appendChild(a)),a}const m={LoaderEvent:n,load(r,e={},t={}){const a=e.src||e.href;let d=h(a,r,e);if(d.getAttribute(v)==="1")return Promise.resolve(d);let u;return new Promise((i,s)=>{function c(){i(d)}function E(){s(`Failed to load ${a}`)}d.addEventListener("load",c,!1),d.addEventListener("error",E,!1),u=()=>{var _;d.removeEventListener("load",c,!1),d.removeEventListener("error",E,!1),document.dispatchEvent(new CustomEvent("complete",{detail:d})),(_=t.oncomplete)==null||_.call(t,d)};const g=15*1e3;setTimeout(()=>s(`Time out of ${g}ms`),g)}).then(i=>{var s;return d.setAttribute(v,"1"),document.dispatchEvent(new CustomEvent("load",{detail:d})),(s=t.onload)==null||s.call(t,d),i}).catch(i=>{var s;throw d.remove(),document.dispatchEvent(new CustomEvent("error",{detail:i})),(s=t.onerror)==null||s.call(t,i),new Error(i)}).finally(u)},loadScript(r,e,t){return this.load("script",y(f({},e),{defer:!0,async:!0,type:"text/javascript",crossOrigin:"anonymous",src:r}),t)},loadCss(r,e,t){return this.load("link",y(f({},e),{rel:"stylesheet",type:"text/css",crossOrigin:"anonymous",href:r}),t)},jsonp(r,e){return w(this,null,function*(){const[t,a]=r.split("?"),d=new URLSearchParams(a);d.append(e.name||"jsonCallback",e.callee);const u=Object.create(e.callbacks||{}),i=u.onload;delete u.onload;const s=yield this.loadScript(t+"?"+d.toString(),void 0,u),c=globalThis[e.callee]();return globalThis[e.callee]=null,s.remove(),i==null||i.call(e,c),c})}};return m.loadScript("demo.js",void 0,{onload(r){console.log(this),console.log(r)}}),l.LoaderEvent=n,l.default=m,l.yamiLoader=m,Object.defineProperties(l,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),l}({});
