(function(r,n){typeof exports=="object"&&typeof module!="undefined"?n(exports):typeof define=="function"&&define.amd?define(["exports"],n):(r=typeof globalThis!="undefined"?globalThis:r||self,n(r.yamiLoader={}))})(this,function(r){"use strict";var O=Object.defineProperty,C=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var L=(r,n,o)=>n in r?O(r,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[n]=o,v=(r,n)=>{for(var o in n||(n={}))j.call(n,o)&&L(r,o,n[o]);if(_)for(var o of _(n))P.call(n,o)&&L(r,o,n[o]);return r},y=(r,n)=>C(r,S(n));var T=(r,n,o)=>new Promise((c,f)=>{var h=e=>{try{d(o.next(e))}catch(t){f(t)}},w=e=>{try{d(o.throw(e))}catch(t){f(t)}},d=e=>e.done?c(e.value):Promise.resolve(e.value).then(h,w);d((o=o.apply(r,n)).next())});var n=(d=>(d.LOAD="load",d.ERROR="error",d.COMPLETE="complete",d))(n||{});const o=document.head||document.getElementsByTagName("head")[0]||document.body,c="loaded";function f(d,e,t){let l=t.id?document.getElementById(t.id):null;if(!l){const i=`${e}[${e==="link"?"href":"src"}="${d}"]`;l=o.querySelector(i)}return l||(l=document.createElement(e),Object.assign(l,t),o.appendChild(l)),l}const h={LoaderEvent:n,load(d,e={},t={}){const l=e.src||e.href;let i=f(l,d,e);if(i.getAttribute(c)==="1")return Promise.resolve(i);let a;return new Promise((s,u)=>{function m(){s(i)}function p(){u(`Failed to load ${l}`)}i.addEventListener("load",m,!1),i.addEventListener("error",p,!1),a=()=>{var g;i.removeEventListener("load",m,!1),i.removeEventListener("error",p,!1),document.dispatchEvent(new CustomEvent("complete",{detail:i})),(g=t.oncomplete)==null||g.call(t,i)};const E=15*1e3;setTimeout(()=>u(`Time out of ${E}ms`),E)}).then(s=>{var u;return i.setAttribute(c,"1"),document.dispatchEvent(new CustomEvent("load",{detail:i})),(u=t.onload)==null||u.call(t,i),s}).catch(s=>{var u;throw i.remove(),document.dispatchEvent(new CustomEvent("error",{detail:s})),(u=t.onerror)==null||u.call(t,s),new Error(s)}).finally(a)},loadScript(d,e,t){return this.load("script",y(v({},e),{defer:!0,async:!0,type:"text/javascript",crossOrigin:"anonymous",src:d}),t)},loadCss(d,e,t){return this.load("link",y(v({},e),{rel:"stylesheet",type:"text/css",crossOrigin:"anonymous",href:d}),t)},jsonp(d,e){return T(this,null,function*(){const[t,l]=d.split("?"),i=new URLSearchParams(l);i.append(e.name||"jsonCallback",e.callee);const a=Object.create(e.callbacks||{}),s=a.onload;delete a.onload;const u=yield this.loadScript(t+"?"+i.toString(),void 0,a),m=globalThis[e.callee]();return globalThis[e.callee]=null,u.remove(),s==null||s.call(e,m),m})}};r.LoaderEvent=n,r.default=h,r.yamiLoader=h,Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
